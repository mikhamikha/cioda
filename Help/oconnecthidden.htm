<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Безопасное подключение к БД</title>
</head>

<body bgcolor="#FFFFFF">
<table border="0" cellpadding="1" cellspacing="1" dir="ltr" style="height:29px; width:100%">
	<tbody>
		<tr>
			<td bgcolor="#111111"><span style="font-size:16px"><font face="Verdana" color="#FFFFFF"><strong>Работа с БД: Безопасное подключение к БД</strong></span></td>
		</tr>
	</tbody>
</table>

<p></p>

<table border="0" cellpadding="1" cellspacing="1" bgcolor="#eeeeee" style="border-collapse:collapse; width:100%">
	<tbody>
		<tr>
			<td><span style="color:#008000"><span style="font-size:14px"><strong><span style="font-family:verdana,geneva,sans-serif">Метод oconnecthidden(string, string)</span></strong></span></span></td>
		</tr>
	</tbody>
</table>

<p><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">Метод безопасного подключения к базе данных Oracle с помощью зашифрованного пароля в Xml-файле</span></span></p>

<p><span style="font-size:14px"><span style="color:rgb(0, 128, 0)"><span style="font-family:verdana,geneva,sans-serif">Синтаксис</span></span></span></p>

<p><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">oconnecthidden( sXML, sXpath )</span></span></p>

<table border="0" cellpadding="1" cellspacing="1" style="border-collapse:collapse; width:100%">
	<tbody>
		<tr>
			<td style="width:20%"><span style="font-size:14px"><span style="color:rgb(0, 128, 0)"><span style="font-family:verdana,geneva,sans-serif">Параметры</span></span></span></td>
			<td>&nbsp;</td>
		</tr>
		<tr>
		<td>&nbsp;</td><td>&nbsp;</td>
		</tr>
		<tr>
			<td><span style="color:#696969"><em><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">sXML</span></span></em></span></td>
			<td><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">Тип: строковый</span></span></td>
		</tr>
		<tr>
			<td>&nbsp;</td>
			<td><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">Путь до конфигурационного файла</span></span></td>
		</tr>
		<tr>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td><span style="color:#696969"><em><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">sXpath</span></span></em></span></td>
			<td><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">Тип: строковый</span></span></td>
		</tr>
		<tr>
			<td>&nbsp;</td>
			<td><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">Путь до узла с атрибутами <strong><em>dsn, user, code</em></strong></span></span></td>
		</tr>
	</tbody>
</table>

<p><br />
<span style="font-size:14px"><span style="color:rgb(0, 128, 0)"><span style="font-family:verdana,geneva,sans-serif">Возвращаемое значение</span></span></span></p>

<p><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">Тип: Integer</span></span><br />
<span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">Номер соединения (&gt;0), если успешно, или 0</span></span>, <span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">если подключение не установлено</span></span></p>

<p><span style="font-size:14px"><span style="color:rgb(0, 128, 0)"><span style="font-family:verdana,geneva,sans-serif">Пример</span></span></span><br />
<p>
<span style="font-family:verdana,geneva,sans-serif"><span style="font-size:12px">&nbsp;&nbsp;&nbsp; <span style="color:#0000FF">STRING </span>sPathDll = <span style="color:#0000FF">PathToStr</span>(&quot;[RUN]:dll\cioda.dll&quot;);</span></span><br />
<span style="font-family:verdana,geneva,sans-serif"><span style="font-size:12px">&nbsp;&nbsp;&nbsp; <span style="color:#0000FF">OBJECT </span>hODAC&nbsp;= <span style="color:#0000FF">DllClassCreate</span>(sPathDll, &quot;cioda&quot;);</span></span><br />
<span style="font-family:verdana,geneva,sans-serif"><br /><span style="font-size:12px">...</span></span></p>

<p><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">&nbsp;&nbsp;&nbsp; <span style="color:#0000FF">INT </span>conId1;<br />
&nbsp;&nbsp; &nbsp;<span style="color:#0000FF">INT </span>stmtId1;<br />
&nbsp;&nbsp; &nbsp;<span style="color:#0000FF">STRING </span>sXML = <span style="color:#0000FF">PathToStr</span>(&quot;[RUN]:dll\appcfg.xml&quot;);<br />
&nbsp;&nbsp; &nbsp;<span style="color:#0000FF">STRING </span>sPathSQL = &quot;.//SQL&quot;;<br />&nbsp;&nbsp; &nbsp;<span style="color:#0000FF">STRING </span>sRole = &quot;falcon_square&quot;;<br />&nbsp;&nbsp; &nbsp;<span style="color:#0000FF">STRING </span>sPrc = &quot;757&quot;;
</span></span></p>

<p><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">&nbsp;&nbsp; &nbsp;// подключаемся к БД<br />
&nbsp;&nbsp; &nbsp;<span style="color:rgb(0, 0, 255)">IF DllClassIsValid</span>( hODAC ) <span style="color:rgb(0, 0, 255)">THEN</span><br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; conId1 = <span style="color:rgb(0, 0, 255)">DllClassCallMethod</span>( hODAC, &quot;oconnecthidden&quot;, sXML, sPathSQL );<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:rgb(0, 0, 255)">DllClassCallMethod</span>( hODAC, &quot;opostconnect&quot;, conId1, sRole, sPrc );<br />
&nbsp;&nbsp;&nbsp; <span style="color:rgb(0, 0, 255)">ENDIF</span></span></span></p>
</p>
</body>

</html>