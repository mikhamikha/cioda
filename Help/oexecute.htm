<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Выполнить запрос SQL</title>
</head>

<body bgcolor="#FFFFFF">
<table border="0" cellpadding="1" cellspacing="1" dir="ltr" style="height:29px; width:100%">
	<tbody>
		<tr>
			<td bgcolor="#111111"><span style="font-size:16px"><font face="Verdana" color="#FFFFFF"><strong>Работа с БД: Выполнить запрос SQL</strong></span></td>
		</tr>
	</tbody>
</table>

<p></p>

<table border="0" cellpadding="1" cellspacing="1" bgcolor="#eeeeee" style="border-collapse:collapse; width:100%">
	<tbody>
		<tr>
			<td><span style="color:#008000"><span style="font-size:14px"><strong><span style="font-family:verdana,geneva,sans-serif">Метод oexecute(int, int)</span></strong></span></span></td>
		</tr>
	</tbody>
</table>

<p><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">Метод, запускающий выполнение сформированного ранее запроса к БД</span></span></p>

<p><span style="font-size:14px"><span style="color:rgb(0, 128, 0)"><span style="font-family:verdana,geneva,sans-serif">Синтаксис</span></span></span></p>

<p><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">oexecute( connectId, stmtId )</span></span></p>

<table border="0" cellpadding="1" cellspacing="1" style="border-collapse:collapse; width:100%">
	<tbody>
		<tr>
			<td style="width:20%"><span style="font-size:14px"><span style="color:rgb(0, 128, 0)"><span style="font-family:verdana,geneva,sans-serif">Параметры</span></span></span></td>
			<td>&nbsp;</td>
		</tr>
		<tr>
		<td>&nbsp;</td><td>&nbsp;</td>
		</tr>
		<tr>
			<td><span style="color:#696969"><em><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">connectId</span></span></em></span></td>
			<td><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">Тип: Целочисленный (32 бит)</span></span></td>
		</tr>
		<tr>
			<td>&nbsp;</td>
			<td><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">Идентификатор подключения к БД</span></span></td>
		</tr>
		<tr>
			<td>&nbsp;</td>
			<td>&nbsp;</td>
		</tr>
		<tr>
			<td><span style="color:#696969"><em><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">stmtId</span></span></em></span></td>
			<td><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">Тип: Целочисленный (32 бит)</span></span></td>
		</tr>
		<tr>
			<td>&nbsp;</td>
			<td><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">Идентификатор сохраненного запроса</span></span></td>
		</tr>
	</tbody>
</table>

<p><br />
<span style="font-size:14px"><span style="color:rgb(0, 128, 0)"><span style="font-family:verdana,geneva,sans-serif">Возвращаемое значение</span></span></span></p>

<p><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">Тип: Integer</span></span><br />
<span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">0, если успешно, или номер ошибки</span></span></p>

<p><span style="font-size:14px"><span style="color:rgb(0, 128, 0)"><span style="font-family:verdana,geneva,sans-serif">Примечание</span></span></span></p>

<p><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">Метод запускает на выполнение сформированный запрос к БД.<br />
Идентификатор подключения был получен методом <a href="oconnecthidden.htm">oconnecthidden()</a>.<br />
Идентификатор запроса был получен методом <a href="osetstatement.htm">osetstatement()</a>.</span></span></p>

<p><span style="font-size:14px"><span style="color:rgb(0, 128, 0)"><span style="font-family:verdana,geneva,sans-serif">Пример</span></span></span><br />
</p>
<p><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">&nbsp;&nbsp;&nbsp; <span style="color:#0000FF">INT </span>rc=-1;<br />
&nbsp;&nbsp; &nbsp;<span style="color:#0000FF">INT </span>conId2;<br />
&nbsp;&nbsp; &nbsp;<span style="color:#0000FF">INT </span>stmtId2;<br />
&nbsp;&nbsp; &nbsp;<span style="color:#0000FF">INT </span>recordsCount;<br />
&nbsp;&nbsp; &nbsp;<span style="color:#0000FF">STRING </span>sXML = <span style="color:#0000FF">PathToStr</span>(&quot;<span style="color:#008000">[RUN]:dll\appcfg.xml</span>&quot;);<br />
&nbsp;&nbsp; &nbsp;<span style="color:#0000FF">STRING </span>sPathSQL = &quot;<span style="color:#008000">.//SQL</span>&quot;;</span></span></p>

<p><span style="font-size:12px"><span style="font-family:verdana,geneva,sans-serif">&nbsp;&nbsp;&nbsp;<span style="color:#696969"> // 1. подключаемся к БД</span><br />
&nbsp;&nbsp; &nbsp;conId2 = <span style="color:#0000FF">DllClassCallMethod</span>( hODAC, &quot;<span style="color:#008000">oconnecthidden</span>&quot;, sXML, sPathSQL );<br />
&nbsp;&nbsp; &nbsp;<span style="color:#0000FF">IF </span>conId2 <span style="color:#0000FF">THEN</span><br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;rc = <span style="color:#0000FF">DllClassCallMethod</span>( hODAC, &quot;<span style="color:#008000">opostconnect</span>&quot;, conId2, &quot;<span style="color:#008000">falcon_square</span>&quot;, &quot;&quot; );<br />
&nbsp;&nbsp; &nbsp;<span style="color:#0000FF">END</span><br />
&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp; &nbsp;<span style="color:#0000FF">IF </span>NOT rc <span style="color:#0000FF">THEN&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="color:rgb(105, 105, 105)">// 2. составляем запрос</span><br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; stmtId2= <span style="color:#0000FF">DllClassCallMethod</span>( hODAC, &quot;<span style="color:#008000">osetstatement</span>&quot;, &quot;<span style="color:#008000">.//Select[@name=^&quot;TANKINFO^&quot;]</span>&quot;, sXML );<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#0000FF">DllClassCallMethod</span>( hODAC, &quot;<span style="color:#008000">osetparameter</span>&quot;, stmtId2, &quot;<span style="color:#008000">:seqno1</span>&quot;, &quot;<span style="color:#008000">10</span>&quot; );&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#0000FF">DllClassCallMethod</span>( hODAC, &quot;<span style="color:#008000">osetparameter</span>&quot;, stmtId2, &quot;<span style="color:#008000">:seqno2</span>&quot;, &quot;<span style="color:#008000">20</span>&quot; );&nbsp;&nbsp; &nbsp;<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#0000FF">DllClassCallMethod</span>( hODAC, &quot;<span style="color:#008000">oaddbindlist</span>&quot;, stmtId2, &quot;<span style="color:#008000">.//BindList[@name=^&quot;TANKINI^&quot;]</span>&quot;, sXML );<br />
<span style="color:#696969">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;// 3. выполним запрос</span><br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#0000FF">DllClassCallMethod</span>( hODAC, &quot;<span style="color:#008000">oexecute</span>&quot;, conId2, stmtId2 );<br />
<span style="color:#696969">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;// 4. выберем записи</span><br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; recordsCount = <span style="color:#0000FF">DllClassCallMethod</span>( hODAC, &quot;<span style="color:#008000">ogetrecordnumber</span>&quot;, stmtId2 );<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#0000FF">DllClassCallMethod</span>( hODAC, &quot;<span style="color:#008000">ogetrecord</span>&quot;, stmtId2, 2, 3 );<br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#0000FF">DllClassCallMethod</span>( hODAC, &quot;<span style="color:#008000">ogetrecord</span>&quot;, stmtId2, 3, 4 );<br />
<span style="color:#696969">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;// 5. очистим выделенные ресурсы</span><br />
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#0000FF">DllClassCallMethod</span>( hODAC, &quot;<span style="color:#008000">oend</span>&quot;, conId2, stmtId2 );<br />
&nbsp;&nbsp; &nbsp;<span style="color:#0000FF">END</span></span></span></p>

</body>

</html>